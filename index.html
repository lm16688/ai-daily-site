<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>AI DAILY â€” æ¯æ—¥ AI ä¸–ç•ŒåŠ¨æ€æ±‡æ€»</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* â”€â”€â”€ RESET & VARIABLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0b0d13;
  --bg-card:rgba(255,255,255,.035);
  --bg-card-hover:rgba(255,255,255,.06);
  --border:rgba(255,255,255,.07);
  --border-strong:rgba(255,255,255,.13);
  --text:#dde0e8;
  --text-dim:#6b7a8f;
  --text-bright:#fff;
  --accent:#7dd3fc;
  --accent-glow:rgba(125,211,252,.18);
  --accent-border:rgba(125,211,252,.28);
  --hot:#ff6b6b;
  --hot-bg:rgba(255,107,107,.1);
  --green:#4ade80;
  --c-news:#7dd3fc;
  --c-tools:#86efac;
  --c-research:#c4b5fd;
  --c-industry:#fcd34d;
  --c-safety:#fca5a5;
}

html{scroll-behavior:smooth}
body{
  font-family:'Noto Sans SC',system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  line-height:1.5;
  -webkit-font-smoothing:antialiased;
}
a{color:inherit;text-decoration:none}
button{font-family:inherit;cursor:pointer;border:none;background:none}
input{font-family:inherit}
img{max-width:100%}

/* â”€â”€â”€ GRAIN OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
body::before{
  content:'';
  position:fixed;inset:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.04'/%3E%3C/svg%3E");
  pointer-events:none;z-index:0;
}

/* â”€â”€â”€ LAYOUT SHELL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.shell{position:relative;z-index:1;max-width:1320px;margin:0 auto;padding:0 28px}

/* â”€â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
header{
  position:relative;z-index:2;
  border-bottom:1px solid var(--border);
  background:linear-gradient(180deg,rgba(15,17,25,.96) 0%,rgba(11,13,19,.85) 100%);
  padding:22px 0 18px;
}
.header-inner{
  display:flex;justify-content:space-between;align-items:center;
  flex-wrap:wrap;gap:18px;
}
.logo{display:flex;align-items:center;gap:16px}
.logo-diamond{
  font-size:32px;color:var(--accent);
  filter:drop-shadow(0 0 14px rgba(125,211,252,.45));
  animation:diamondPulse 3s ease-in-out infinite;
}
@keyframes diamondPulse{0%,100%{filter:drop-shadow(0 0 10px rgba(125,211,252,.4))}50%{filter:drop-shadow(0 0 22px rgba(125,211,252,.7))}}
.logo-text h1{
  font-family:'Bebas Neue',sans-serif;
  font-size:30px;letter-spacing:.3em;color:#fff;
  line-height:1;
}
.logo-text p{font-size:11px;color:var(--text-dim);letter-spacing:.18em;margin-top:3px}

.stats-row{display:flex;gap:24px}
.stat{display:flex;flex-direction:column;align-items:center}
.stat-val{font-size:21px;font-weight:700;color:var(--accent)}
.stat-lbl{font-size:10px;color:var(--text-dim);letter-spacing:.06em;text-transform:uppercase}

.live-badge{
  display:flex;align-items:center;gap:7px;
  background:var(--accent-glow);border:1px solid var(--accent-border);
  border-radius:20px;padding:5px 13px;
}
.live-dot{
  width:7px;height:7px;border-radius:50%;background:var(--green);
  box-shadow:0 0 7px var(--green);
  animation:blink 2s ease-in-out infinite;
}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.live-badge span{font-size:11.5px;color:var(--accent);font-weight:500}

/* â”€â”€â”€ CONTROLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.controls{
  position:relative;z-index:2;
  padding:18px 0 4px;display:flex;flex-direction:column;gap:14px;
}
.controls-header{
  display:flex;justify-content:space-between;align-items:center;
  gap:12px;flex-wrap:wrap;
}
.search-wrap{
  display:flex;align-items:center;gap:8px;
  background:rgba(255,255,255,.04);
  border:1px solid var(--border);border-radius:10px;
  padding:0 15px;flex:1;max-width:400px;
  transition:border-color .2s;
}
.search-wrap:focus-within{border-color:var(--accent-border)}
.search-wrap svg{width:17px;height:17px;color:var(--text-dim);flex-shrink:0}
.search-wrap input{
  flex:1;background:transparent;border:none;outline:none;
  color:var(--text);font-size:14px;padding:11px 0;
}
.search-wrap input::placeholder{color:var(--text-dim)}

.refresh-btn{
  display:flex;align-items:center;gap:6px;
  background:var(--bg-card);border:1px solid var(--border);
  color:var(--text-dim);border-radius:8px;
  padding:8px 14px;font-size:12px;font-weight:500;
  transition:all .2s;white-space:nowrap;
}
.refresh-btn:hover{border-color:var(--accent-border);color:var(--accent)}
.refresh-btn:active{transform:scale(0.96)}
.refresh-btn.spinning svg{animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

.cat-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.cat-btn{
  display:flex;align-items:center;gap:6px;
  background:rgba(255,255,255,.04);border:1px solid var(--border);
  border-radius:22px;padding:6px 15px;
  color:var(--text-dim);font-size:13px;font-weight:500;
  transition:all .2s;
}
.cat-btn:hover{border-color:var(--border-strong);color:var(--text)}
.cat-btn.active{
  background:var(--accent-glow);
  border-color:var(--accent-border);color:var(--accent);
}
.cat-btn .cnt{
  font-size:10.5px;background:rgba(255,255,255,.08);
  border-radius:10px;padding:1px 7px;color:var(--text-dim);
}
.cat-btn.active .cnt{background:rgba(125,211,252,.15);color:var(--accent)}

/* â”€â”€â”€ MAIN GRID LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main-layout{
  display:grid;
  grid-template-columns:1fr 340px;
  gap:28px;padding:22px 0 48px;
  align-items:start;
}

/* â”€â”€â”€ SECTION HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.section-head{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:16px;
}
.section-head h2{
  font-size:15px;font-weight:600;color:#fff;
  display:flex;align-items:center;gap:8px;
}
.section-head .accent-dash{color:var(--accent);font-size:20px;font-weight:700}
.section-head .item-count{font-size:12px;color:var(--text-dim)}

/* â”€â”€â”€ NEWS CARDS GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.cards-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:15px;
}

/* â”€â”€â”€ SINGLE CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.card{
  background:var(--bg-card);
  border:1px solid var(--border);border-radius:14px;
  padding:20px 18px 16px;
  position:relative;overflow:hidden;
  transition:border-color .25s,box-shadow .25s,transform .25s;
  opacity:0;transform:translateY(18px);
}
.card.visible{
  opacity:1;transform:translateY(0);
  transition:opacity .45s cubic-bezier(.22,.68,0,1.2),
             transform .45s cubic-bezier(.22,.68,0,1.2),
             border-color .25s,box-shadow .25s;
}
.card:hover{
  border-color:var(--border-strong);
  box-shadow:0 4px 24px rgba(0,0,0,.25);
  transform:translateY(-2px);
}

.card::before{
  content:'';position:absolute;
  top:0;left:0;width:3px;height:100%;
}
.hot-badge{
  position:absolute;top:10px;right:10px;
  font-size:11px;font-weight:600;color:var(--hot);
  background:var(--hot-bg);border-radius:12px;padding:2px 8px;
  white-space:nowrap;
}
.card-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:7px}
.card-cat{font-size:11px;font-weight:600;letter-spacing:.06em}
.card-date{font-size:11px;color:var(--text-dim)}
.card h3{font-size:15px;font-weight:600;color:#fff;line-height:1.35;margin-bottom:8px}
.card p{font-size:13px;color:var(--text-dim);line-height:1.55;margin-bottom:12px}
.card-tags{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:14px}
.card-tags span{
  font-size:11px;color:var(--text-dim);
  background:rgba(255,255,255,.06);border-radius:4px;padding:2px 8px;
}
.card-foot{
  display:flex;justify-content:space-between;align-items:center;
  border-top:1px solid var(--border);padding-top:10px;
}
.card-source{font-size:11px;color:#4a5568}
.read-link{
  font-size:12px;font-weight:500;color:var(--accent);
  transition:color .2s;
}
.read-link:hover{color:#fff}

/* â”€â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar{display:flex;flex-direction:column;gap:16px}

.side-card{
  background:var(--bg-card);
  border:1px solid var(--border);border-radius:14px;padding:18px;
}
.side-card h3{
  font-size:14px;font-weight:600;color:#fff;
  display:flex;align-items:center;gap:6px;margin-bottom:12px;
}

.hot-list{display:flex;flex-direction:column;gap:2px}
.hot-item{
  display:flex;align-items:flex-start;gap:10px;
  padding:7px 0;border-bottom:1px solid var(--border);
  transition:opacity .2s;
}
.hot-item:last-child{border-bottom:none}
.hot-item:hover{opacity:.75}
.hot-rank{
  font-size:13px;font-weight:700;color:var(--accent);
  width:18px;flex-shrink:0;text-align:center;padding-top:1px;
}
.hot-title{font-size:13px;color:#c8cdd8;line-height:1.4}

.xhs-head{display:flex;justify-content:space-between;align-items:center}
.xhs-toggle{
  font-size:12px;color:var(--accent);font-weight:500;
  background:var(--accent-glow);border:1px solid var(--accent-border);
  border-radius:14px;padding:3px 13px;transition:background .2s;
}
.xhs-toggle:hover{background:rgba(125,211,252,.26)}
.xhs-desc{font-size:12px;color:var(--text-dim);line-height:1.5;margin-bottom:10px}
.xhs-body{
  display:none;
  background:rgba(0,0,0,.3);border:1px solid var(--border);
  border-radius:10px;overflow:hidden;
  animation:fadeDown .3s ease;
}
.xhs-body.open{display:block}
@keyframes fadeDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.xhs-pre{
  padding:15px 17px;font-size:13px;color:#b8bec9;
  line-height:1.65;white-space:pre-wrap;word-break:break-word;
  max-height:380px;overflow-y:auto;
}
.xhs-actions{
  padding:10px 17px;border-top:1px solid var(--border);
  display:flex;justify-content:center;gap:10px;
}
.copy-btn{
  background:linear-gradient(135deg,#7dd3fc,#60a5fa);
  border-radius:8px;color:#0b0d13;font-weight:700;font-size:13px;
  padding:8px 26px;letter-spacing:.04em;
  transition:filter .2s,transform .1s;
}
.copy-btn:hover{filter:brightness(1.15)}
.copy-btn:active{transform:scale(.96)}
.copy-btn.done{background:linear-gradient(135deg,#4ade80,#22c55e)}

.tag-cloud{display:flex;flex-wrap:wrap;gap:6px}
.tag{
  font-size:12px;color:var(--accent);
  background:var(--accent-glow);border:1px solid var(--accent-border);
  border-radius:14px;padding:3px 11px;cursor:pointer;
  transition:background .2s;
}
.tag:hover{background:rgba(125,211,252,.28)}

/* â”€â”€â”€ LOADING & ERROR STATES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.loading-overlay{
  position:fixed;inset:0;background:rgba(11,13,19,.95);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:100;gap:20px;
}
.loading-spinner{
  width:50px;height:50px;border:3px solid rgba(125,211,252,.1);
  border-top-color:var(--accent);border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{color:var(--accent);font-size:14px;letter-spacing:.1em}
.error-msg{
  background:rgba(255,107,107,.1);border:1px solid var(--hot);
  color:var(--hot);padding:12px 20px;border-radius:8px;
  font-size:13px;margin-bottom:12px;display:none;
}
.error-msg.success{
  background:rgba(74,222,128,.1);border-color:var(--green);color:var(--green);
}

/* â”€â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
footer{
  position:relative;z-index:1;
  border-top:1px solid var(--border);padding:18px 28px;text-align:center;
}
footer p{font-size:11px;color:#4a5568}

/* â”€â”€â”€ SCROLLBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,.12);border-radius:3px}

/* â”€â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media(max-width:900px){
  .main-layout{grid-template-columns:1fr}
  .sidebar{order:-1}
  .controls-header{flex-direction:column;align-items:stretch}
  .search-wrap{max-width:none}
}
@media(max-width:560px){
  .shell{padding:0 16px}
  .header-inner{flex-direction:column;align-items:flex-start}
  .stats-row{gap:16px}
  .cards-grid{grid-template-columns:1fr}
  .logo-text h1{font-size:24px}
}
</style>
</head>
<body>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-spinner"></div>
  <div class="loading-text">æ­£åœ¨è·å–ä»Šæ—¥ AI èµ„è®¯...</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header>
<div class="shell">
<div class="header-inner">
  <div class="logo">
    <span class="logo-diamond">â—†</span>
    <div class="logo-text">
      <h1>AI DAILY</h1>
      <p>æ¯æ—¥ AI ä¸–ç•ŒåŠ¨æ€æ±‡æ€»</p>
    </div>
  </div>
  <div style="display:flex;align-items:center;gap:22px;flex-wrap:wrap">
    <div class="stats-row">
      <div class="stat"><span class="stat-val" id="statTotal">--</span><span class="stat-lbl">èµ„è®¯æ•°</span></div>
      <div class="stat"><span class="stat-val" id="statTools">--</span><span class="stat-lbl">å·¥å…·æ•°</span></div>
      <div class="stat"><span class="stat-val" id="statHot">--</span><span class="stat-lbl">çƒ­ç‚¹æ•°</span></div>
    </div>
    <div class="live-badge">
      <span class="live-dot"></span>
      <span id="liveTime">æ›´æ–°ä¸­...</span>
    </div>
  </div>
</div>
</div>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTROLS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="shell">
<div class="controls">
  <div class="error-msg" id="errorMsg">
    <span id="errorText"></span>
  </div>
  
  <div class="controls-header">
    <div class="search-wrap">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      <input type="text" id="searchInput" placeholder="æœç´¢èµ„è®¯ã€å·¥å…·ã€æ ‡ç­¾â€¦" autocomplete="off">
    </div>
    <button class="refresh-btn" id="refreshBtn" onclick="checkForUpdates()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
      æ£€æŸ¥æ›´æ–°
    </button>
  </div>
  
  <div class="cat-row" id="catRow"></div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="shell">
<div class="main-layout">

  <!-- LEFT: cards -->
  <section>
    <div class="section-head">
      <h2><span class="accent-dash">â€”</span> ä»Šæ—¥æ±‡æ€»</h2>
      <span class="item-count" id="itemCount">åŠ è½½ä¸­...</span>
    </div>
    <div class="cards-grid" id="cardsGrid"></div>
  </section>

  <!-- RIGHT: sidebar -->
  <aside class="sidebar">

    <!-- hot list -->
    <div class="side-card">
      <h3>ğŸ”¥ ä»Šæ—¥ TOP çƒ­ç‚¹</h3>
      <div class="hot-list" id="hotList"></div>
    </div>

    <!-- XHS generator -->
    <div class="side-card">
      <div class="xhs-head">
        <h3 style="margin-bottom:0">ğŸ“ å°çº¢ä¹¦ç¬”è®°ç”Ÿæˆ</h3>
        <button class="xhs-toggle" id="xhsToggle">å±•å¼€</button>
      </div>
      <p class="xhs-desc">æ¯æ—¥è‡ªåŠ¨æ ¹æ®æ±‡æ€»å†…å®¹ç”Ÿæˆå°çº¢ä¹¦ç¬”è®°ï¼Œä¸€é”®å¤åˆ¶å³å¯å‘å¸ƒã€‚</p>
      <div class="xhs-body" id="xhsBody">
        <pre class="xhs-pre" id="xhsPre"></pre>
        <div class="xhs-actions">
          <button class="copy-btn" id="copyBtn">ğŸ“‹ å¤åˆ¶ç¬”è®°</button>
        </div>
      </div>
    </div>

    <!-- tag cloud -->
    <div class="side-card">
      <h3>ğŸ·ï¸ çƒ­é—¨æ ‡ç­¾</h3>
      <div class="tag-cloud" id="tagCloud"></div>
    </div>

  </aside>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<footer>
<p>AI DAILY Â· æ•°æ®æ¥æºï¼šNewsAPI / TechCrunch / MIT Technology Review / æœºå™¨ä¹‹å¿ƒ / 36æ°ª Â· æ¯æ—¥è‡ªåŠ¨æ›´æ–° Â· å†…å®¹ä»…ä¾›å‚è€ƒ</p>
</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATA + LOGIC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€â”€ CONFIGURATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const CONFIG = {
  DATA_URL: './news_data.json',
  CACHE_KEY: 'ai_daily_cache',
  CACHE_TTL: 6 * 60 * 60 * 1000, // 6å°æ—¶
  REFRESH_INTERVAL: 30 * 60 * 1000, // 30åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
};

/* â”€â”€â”€ CATEGORY CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const CATS = [
  {id:'all',     label:'å…¨éƒ¨',     icon:'ğŸŒ'},
  {id:'news',    label:'è¡Œä¸šåŠ¨æ€', icon:'ğŸ“°'},
  {id:'tools',   label:'AI å·¥å…·',  icon:'ğŸ› ï¸'},
  {id:'research',label:'ç ”ç©¶å‰æ²¿', icon:'ğŸ”¬'},
  {id:'industry',label:'å•†ä¸šåº”ç”¨', icon:'ğŸ’¼'},
  {id:'safety',  label:'å®‰å…¨ä¸ä¼¦ç†',icon:'ğŸ›¡ï¸'},
];

const CAT_COLOR = {
  news:'var(--c-news)',
  tools:'var(--c-tools)',
  research:'var(--c-research)',
  industry:'var(--c-industry)',
  safety:'var(--c-safety)'
};

/* â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let activeCat = 'all';
let searchVal = '';
let NEWS = [];
let lastUpdateTime = null;
let isFallback = false;

/* â”€â”€â”€ CACHE MANAGEMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function getCache() {
  try {
    const cached = localStorage.getItem(CONFIG.CACHE_KEY);
    if (!cached) return null;
    const data = JSON.parse(cached);
    if (Date.now() - data.timestamp > CONFIG.CACHE_TTL) {
      localStorage.removeItem(CONFIG.CACHE_KEY);
      return null;
    }
    return data;
  } catch (e) {
    return null;
  }
}

function setCache(newsData, meta = {}) {
  try {
    localStorage.setItem(CONFIG.CACHE_KEY, JSON.stringify({
      timestamp: Date.now(),
      news: newsData,
      meta: meta
    }));
  } catch (e) {
    console.warn('Cache failed:', e);
  }
}

/* â”€â”€â”€ DATA FETCHING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function fetchFromAPI() {
  try {
    const response = await fetch(CONFIG.DATA_URL + '?t=' + Date.now());
    if (!response.ok) throw new Error('Network error');
    
    const data = await response.json();
    
    if (data.news && Array.isArray(data.news)) {
      lastUpdateTime = new Date(data.meta?.lastUpdated || Date.now());
      isFallback = data.meta?.isFallback || false;
      return data.news;
    }
    
    if (Array.isArray(data)) return data;
    throw new Error('Invalid format');
    
  } catch (error) {
    // å¼€å‘ç¯å¢ƒä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
    if (location.hostname === 'localhost' || location.protocol === 'file:') {
      console.log('Using mock data');
      return generateMockData();
    }
    throw error;
  }
}

function generateMockData() {
  const today = new Date().toISOString().split('T')[0];
  return [
    {id:1,cat:'news',hot:true,title:'OpenAI å‘å¸ƒ GPT-5 é¢„è§ˆç‰ˆ',summary:'æ–°æ¨¡å‹åœ¨æ•°å­¦æ¨ç†å’Œä»£ç ç”Ÿæˆæ–¹é¢è¡¨ç°ä¼˜å¼‚ã€‚',source:'TechCrunch',date:today,url:'#',tags:['OpenAI','GPT-5']},
    {id:2,cat:'tools',hot:true,title:'Cursor Pro ç‰ˆæœ¬å‘å¸ƒ',summary:'æ”¯æŒå¤šæ–‡ä»¶åŒæ—¶ç¼–è¾‘å’Œè‡ªåŠ¨ä»£ç å®¡æŸ¥ã€‚',source:'The Verge',date:today,url:'#',tags:['Cursor','ç¼–ç¨‹']},
    {id:3,cat:'research',hot:true,title:'DeepMind è›‹ç™½è´¨é¢„æµ‹æ–°çªç ´',summary:'AlphaFold 3 èƒ½å¤Ÿé¢„æµ‹ DNAã€RNA ç»“æ„ã€‚',source:'MIT',date:today,url:'#',tags:['DeepMind','ç”Ÿç‰©AI']},
    {id:4,cat:'industry',hot:false,title:'Cerebras è· 5 äº¿ç¾å…ƒèèµ„',summary:'AI èŠ¯ç‰‡å…¬å¸ä¼°å€¼è¶… 40 äº¿ç¾å…ƒã€‚',source:'Bloomberg',date:today,url:'#',tags:['èèµ„','èŠ¯ç‰‡']},
    {id:5,cat:'safety',hot:true,title:'æ¬§ç›Ÿé€šè¿‡ AI æ³•æ¡ˆæœ€ç»ˆç‰ˆ',summary:'å…¨çƒé¦–éƒ¨å…¨é¢ç›‘ç®¡ AI çš„æ³•å¾‹ã€‚',source:'Reuters',date:today,url:'#',tags:['ç›‘ç®¡','æ¬§ç›Ÿ']},
  ];
}

async function fetchNewsData(force = false) {
  if (!force) {
    const cached = getCache();
    if (cached?.news?.length > 0) {
      NEWS = cached.news;
      renderAll();
      document.getElementById('loadingOverlay').style.display = 'none';
      return;
    }
  }

  try {
    document.getElementById('loadingOverlay').style.display = 'flex';
    hideError();
    
    const data = await fetchFromAPI();
    NEWS = data;
    
    setCache(NEWS, { lastUpdated: new Date().toISOString() });
    
  } catch (error) {
    console.error('Fetch error:', error);
    showError('è·å–æ•°æ®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åé‡è¯•');
    
    // ä½¿ç”¨è¿‡æœŸç¼“å­˜
    const cached = getCache();
    if (cached?.news) {
      NEWS = cached.news;
      showError('æ˜¾ç¤ºç¼“å­˜æ•°æ®ï¼Œç‚¹å‡»å³ä¸Šè§’åˆ·æ–°é‡è¯•');
    }
  } finally {
    document.getElementById('loadingOverlay').style.display = 'none';
  }
}

/* â”€â”€â”€ UI HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showError(msg) {
  const el = document.getElementById('errorMsg');
  document.getElementById('errorText').textContent = msg;
  el.style.display = 'block';
  el.classList.remove('success');
}

function showSuccess(msg) {
  const el = document.getElementById('errorMsg');
  document.getElementById('errorText').textContent = msg;
  el.style.display = 'block';
  el.classList.add('success');
  setTimeout(hideError, 3000);
}

function hideError() {
  document.getElementById('errorMsg').style.display = 'none';
}

/* â”€â”€â”€ CHECK UPDATES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function checkForUpdates() {
  const btn = document.getElementById('refreshBtn');
  btn.classList.add('spinning');
  btn.disabled = true;
  
  try {
    const response = await fetch(CONFIG.DATA_URL + '?t=' + Date.now());
    const data = await response.json();
    const newNews = data.news || [];
    
    // ç®€å•æ¯”è¾ƒï¼šæ£€æŸ¥æ•°é‡å’Œç¬¬ä¸€æ¡
    const currentIds = NEWS.map(n => n.id).join(',');
    const newIds = newNews.map(n => n.id).join(',');
    
    if (currentIds !== newIds && newNews.length > 0) {
      NEWS = newNews;
      setCache(NEWS, data.meta);
      renderAll();
      showSuccess('âœ… å·²æ›´æ–°åˆ°æœ€æ–°å†…å®¹ï¼');
    } else {
      showSuccess('â„¹ï¸ å½“å‰å·²æ˜¯æœ€æ–°å†…å®¹');
    }
  } catch (e) {
    showError('æ£€æŸ¥æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
  } finally {
    btn.classList.remove('spinning');
    btn.disabled = false;
  }
}

/* â”€â”€â”€ RENDER FUNCTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function filtered(){
  return NEWS.filter(item => {
    const matchCat = activeCat === 'all' || item.cat === activeCat;
    const q = searchVal.trim().toLowerCase();
    const matchQ = !q ||
      item.title.toLowerCase().includes(q) ||
      item.summary.toLowerCase().includes(q) ||
      item.tags.some(t => t.toLowerCase().includes(q));
    return matchCat && matchQ;
  });
}

function catLabel(id){ return CATS.find(c=>c.id===id)?.label || id; }
function catCount(id){ return id==='all' ? NEWS.length : NEWS.filter(i=>i.cat===id).length; }

function generateXHS(){
  const today = new Date().toLocaleDateString('zh-CN');
  const hot = NEWS.filter(i=>i.hot).slice(0,5);
  const tools = NEWS.filter(i=>i.cat==='tools').slice(0,3);
  const res = NEWS.filter(i=>i.cat==='research').slice(0,2);
  const ranks = ['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰','â‘£','â‘¤'];

  let n = `ğŸ¤– AIæ—¥æŠ¥ | ${today}\n`;
  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  n += `âœ¨ ä»Šæ—¥å¿…çœ‹ TOPçƒ­ç‚¹\n\n`;
  hot.forEach((item,i) => { n += `${ranks[i]} ${item.title}\nâ†’ ${item.summary.slice(0,60)}...\n\n`; });

  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
  n += `ğŸ› ï¸ ä»Šæ—¥å·¥å…·æ¨è\n\n`;
  tools.forEach(item => { n += `ğŸ’ ${item.title}\n${item.summary.slice(0,50)}...\n\n`; });

  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
  n += `ğŸ”¬ å‰æ²¿ç ”ç©¶ä¸€ç¥\n\n`;
  res.forEach(item => { n += `ğŸ“Œ ${item.title}\n${item.summary.slice(0,50)}...\n\n`; });

  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
  n += `ğŸ’¡ ä»Šæ—¥ AI é‡‘å¥\n`;
  n += `"2026 ä¸æ˜¯ AI çš„ç»ˆç»“ï¼Œè€Œæ˜¯å®ƒä»ç‚’ä½œèµ°å‘åŠ¡å®çš„èµ·ç‚¹ã€‚"\n\n`;
  n += `#AIæ—¥æŠ¥ #äººå·¥æ™ºèƒ½ #AIå·¥å…· #ç§‘æŠ€èµ„è®¯`;
  return n;
}

function renderCatBar(){
  const el = document.getElementById('catRow');
  el.innerHTML = CATS.map(c => `
    <button class="cat-btn ${c.id===activeCat?'active':''}" data-cat="${c.id}">
      <span>${c.icon}</span>${c.label}
      <span class="cnt">${catCount(c.id)}</span>
    </button>`).join('');
  
  el.querySelectorAll('.cat-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      activeCat = btn.dataset.cat;
      renderAll();
    });
  });
}

function renderCards(){
  const items = filtered();
  document.getElementById('itemCount').textContent = items.length + ' é¡¹';

  const grid = document.getElementById('cardsGrid');
  
  if (items.length === 0) {
    grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:60px;color:var(--text-dim)">æš‚æ— ç›¸å…³èµ„è®¯</div>';
    return;
  }
  
  grid.innerHTML = items.map((item,idx) => `
    <article class="card" data-idx="${idx}">
      <style>.card[data-idx="${idx}"]::before{background:${CAT_COLOR[item.cat]}}</style>
      ${item.hot ? '<span class="hot-badge">ğŸ”¥ çƒ­ç‚¹</span>' : ''}
      <div class="card-meta">
        <span class="card-cat" style="color:${CAT_COLOR[item.cat]}">${catLabel(item.cat)}</span>
        <span class="card-date">${item.date}</span>
      </div>
      <h3>${item.title}</h3>
      <p>${item.summary}</p>
      <div class="card-tags">${item.tags.map(t=>`<span>${t}</span>`).join('')}</div>
      <div class="card-foot">
        <span class="card-source">${item.source}</span>
        <a href="${item.url}" target="_blank" rel="noopener" class="read-link">æŸ¥çœ‹åŸæ–‡ â†’</a>
      </div>
    </article>`).join('');

  requestAnimationFrame(() => {
    grid.querySelectorAll('.card').forEach((card,i) => {
      setTimeout(() => card.classList.add('visible'), i * 75);
    });
  });
}

function renderHotList(){
  const hots = NEWS.filter(i=>i.hot).slice(0,6);
  document.getElementById('hotList').innerHTML = hots.length ? hots.map((item,i) => `
    <a href="${item.url}" target="_blank" class="hot-item">
      <span class="hot-rank">${i+1}</span>
      <span class="hot-title">${item.title}</span>
    </a>`).join('') : '<div style="color:var(--text-dim);padding:10px">æš‚æ— çƒ­ç‚¹</div>';
}

function renderTagCloud(){
  const tags = [...new Set(NEWS.flatMap(i=>i.tags))];
  const el = document.getElementById('tagCloud');
  el.innerHTML = tags.length ? tags.map(t => `<span class="tag" data-tag="${t}">#${t}</span>`).join('') : '<span style="color:var(--text-dim);font-size:12px">æš‚æ— æ ‡ç­¾</span>';
  el.querySelectorAll('.tag').forEach(span => {
    span.addEventListener('click', () => {
      searchVal = span.dataset.tag;
      document.getElementById('searchInput').value = searchVal;
      renderAll();
    });
  });
}

function renderXHS(){
  document.getElementById('xhsPre').textContent = generateXHS();
}

function renderStats(){
  document.getElementById('statTotal').textContent = NEWS.length || '--';
  document.getElementById('statTools').textContent = NEWS.filter(i=>i.cat==='tools').length || '--';
  document.getElementById('statHot').textContent = NEWS.filter(i=>i.hot).length || '--';
}

function renderAll(){
  renderCatBar();
  renderCards();
  renderHotList();
  renderTagCloud();
  renderXHS();
  renderStats();
  updateTime();
}

function updateTime(){
  const now = new Date();
  const m = String(now.getMonth()+1).padStart(2,'0');
  const d = String(now.getDate()).padStart(2,'0');
  const h = String(now.getHours()).padStart(2,'0');
  const mi = String(now.getMinutes()).padStart(2,'0');
  
  let timeStr = `${m}æœˆ${d}æ—¥ ${h}:${mi}`;
  if (lastUpdateTime) {
    const diff = Math.floor((now - lastUpdateTime) / 60000);
    if (diff < 1) timeStr += ' (åˆšåˆš)';
    else if (diff < 60) timeStr += ` (${diff}åˆ†é’Ÿå‰)`;
    if (isFallback) timeStr += ' [å¤‡ç”¨]';
  }
  
  document.getElementById('liveTime').textContent = `å·²æ›´æ–° ${timeStr}`;
}

/* â”€â”€â”€ EVENT LISTENERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('searchInput').addEventListener('input', e => {
  searchVal = e.target.value;
  renderAll();
});

document.getElementById('xhsToggle').addEventListener('click', function(){
  const body = document.getElementById('xhsBody');
  const open = body.classList.toggle('open');
  this.textContent = open ? 'æ”¶èµ·' : 'å±•å¼€';
});

document.getElementById('copyBtn').addEventListener('click', function(){
  const text = document.getElementById('xhsPre').textContent;
  navigator.clipboard.writeText(text).then(() => {
    this.textContent = 'âœ“ å·²å¤åˆ¶ï¼';
    this.classList.add('done');
    setTimeout(() => {
      this.textContent = 'ğŸ“‹ å¤åˆ¶ç¬”è®°';
      this.classList.remove('done');
    }, 2200);
  });
});

/* â”€â”€â”€ INITIALIZATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function init() {
  await fetchNewsData();
  renderAll();
  
  // å®šæ—¶æ£€æŸ¥æ›´æ–°
  setInterval(checkForUpdates, CONFIG.REFRESH_INTERVAL);
  
  // é¡µé¢å¯è§æ—¶æ£€æŸ¥
  document.addEventListener('visibilitychange', () => {
    if (!document.hidden) checkForUpdates();
  });
}

init();
</script>
</body>
</html>
