<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https:; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com;">
<title>AI DAILY â€” æ¯æ—¥ AI ä¸–ç•ŒåŠ¨æ€æ±‡æ€»</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* â”€â”€â”€ RESET & VARIABLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0b0d13;
  --bg-card:rgba(255,255,255,.035);
  --bg-card-hover:rgba(255,255,255,.06);
  --border:rgba(255,255,255,.07);
  --border-strong:rgba(255,255,255,.13);
  --text:#dde0e8;
  --text-dim:#6b7a8f;
  --text-bright:#fff;
  --accent:#7dd3fc;          /* cyan */
  --accent-glow:rgba(125,211,252,.18);
  --accent-border:rgba(125,211,252,.28);
  --hot:#ff6b6b;
  --hot-bg:rgba(255,107,107,.1);
  --green:#4ade80;
  /* category colours */
  --c-news:#7dd3fc;
  --c-tools:#86efac;
  --c-research:#c4b5fd;
  --c-industry:#fcd34d;
  --c-safety:#fca5a5;
}

html{scroll-behavior:smooth}
body{
  font-family:'Noto Sans SC',system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  line-height:1.5;
  -webkit-font-smoothing:antialiased;
}
a{color:inherit;text-decoration:none}
button{font-family:inherit;cursor:pointer;border:none;background:none}
input{font-family:inherit}
img{max-width:100%}

/* â”€â”€â”€ GRAIN OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
body::before{
  content:'';
  position:fixed;inset:0;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.04'/%3E%3C/svg%3E");
  pointer-events:none;z-index:0;
}

/* â”€â”€â”€ LAYOUT SHELL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.shell{position:relative;z-index:1;max-width:1320px;margin:0 auto;padding:0 28px}

/* â”€â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
header{
  position:relative;z-index:2;
  border-bottom:1px solid var(--border);
  background:linear-gradient(180deg,rgba(15,17,25,.96) 0%,rgba(11,13,19,.85) 100%);
  padding:22px 0 18px;
}
.header-inner{
  display:flex;justify-content:space-between;align-items:center;
  flex-wrap:wrap;gap:18px;
}
/* logo */
.logo{display:flex;align-items:center;gap:16px}
.logo-diamond{
  font-size:32px;color:var(--accent);
  filter:drop-shadow(0 0 14px rgba(125,211,252,.45));
  animation:diamondPulse 3s ease-in-out infinite;
}
@keyframes diamondPulse{0%,100%{filter:drop-shadow(0 0 10px rgba(125,211,252,.4))}50%{filter:drop-shadow(0 0 22px rgba(125,211,252,.7))}}
.logo-text h1{
  font-family:'Bebas Neue',sans-serif;
  font-size:30px;letter-spacing:.3em;color:#fff;
  line-height:1;
}
.logo-text p{font-size:11px;color:var(--text-dim);letter-spacing:.18em;margin-top:3px}

/* stats row */
.stats-row{display:flex;gap:24px}
.stat{display:flex;flex-direction:column;align-items:center}
.stat-val{font-size:21px;font-weight:700;color:var(--accent)}
.stat-lbl{font-size:10px;color:var(--text-dim);letter-spacing:.06em;text-transform:uppercase}

/* live badge */
.live-badge{
  display:flex;align-items:center;gap:7px;
  background:var(--accent-glow);border:1px solid var(--accent-border);
  border-radius:20px;padding:5px 13px;
}
.live-dot{
  width:7px;height:7px;border-radius:50%;background:var(--green);
  box-shadow:0 0 7px var(--green);
  animation:blink 2s ease-in-out infinite;
}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.live-badge span{font-size:11.5px;color:var(--accent);font-weight:500}

/* â”€â”€â”€ CONTROLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.controls{
  position:relative;z-index:2;
  padding:18px 0 4px;display:flex;flex-direction:column;gap:14px;
}
/* search */
.search-wrap{
  display:flex;align-items:center;gap:8px;
  background:rgba(255,255,255,.04);
  border:1px solid var(--border);border-radius:10px;
  padding:0 15px;max-width:460px;width:100%;
  transition:border-color .2s;
}
.search-wrap:focus-within{border-color:var(--accent-border)}
.search-wrap svg{width:17px;height:17px;color:var(--text-dim);flex-shrink:0}
.search-wrap input{
  flex:1;background:transparent;border:none;outline:none;
  color:var(--text);font-size:14px;padding:11px 0;
}
.search-wrap input::placeholder{color:var(--text-dim)}

/* category pills */
.cat-row{display:flex;gap:8px;flex-wrap:wrap}
.cat-btn{
  display:flex;align-items:center;gap:6px;
  background:rgba(255,255,255,.04);border:1px solid var(--border);
  border-radius:22px;padding:6px 15px;
  color:var(--text-dim);font-size:13px;font-weight:500;
  transition:all .2s;
}
.cat-btn:hover{border-color:var(--border-strong);color:var(--text)}
.cat-btn.active{
  background:var(--accent-glow);
  border-color:var(--accent-border);color:var(--accent);
}
.cat-btn .cnt{
  font-size:10.5px;background:rgba(255,255,255,.08);
  border-radius:10px;padding:1px 7px;color:var(--text-dim);
}
.cat-btn.active .cnt{background:rgba(125,211,252,.15);color:var(--accent)}

/* â”€â”€â”€ MAIN GRID LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main-layout{
  display:grid;
  grid-template-columns:1fr 340px;
  gap:28px;padding:22px 0 48px;
  align-items:start;
}

/* â”€â”€â”€ SECTION HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.section-head{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:16px;
}
.section-head h2{
  font-size:15px;font-weight:600;color:#fff;
  display:flex;align-items:center;gap:8px;
}
.section-head .accent-dash{color:var(--accent);font-size:20px;font-weight:700}
.section-head .item-count{font-size:12px;color:var(--text-dim)}

/* â”€â”€â”€ NEWS CARDS GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.cards-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:15px;
}

/* â”€â”€â”€ SINGLE CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.card{
  background:var(--bg-card);
  border:1px solid var(--border);border-radius:14px;
  padding:20px 18px 16px;
  position:relative;overflow:hidden;
  transition:border-color .25s,box-shadow .25s,transform .25s;
  /* staggered fade-in */
  opacity:0;transform:translateY(18px);
}
.card.visible{
  opacity:1;transform:translateY(0);
  transition:opacity .45s cubic-bezier(.22,.68,0,1.2),
             transform .45s cubic-bezier(.22,.68,0,1.2),
             border-color .25s,box-shadow .25s;
}
.card:hover{
  border-color:var(--border-strong);
  box-shadow:0 4px 24px rgba(0,0,0,.25);
  transform:translateY(-2px);
}

/* left colour stripe */
.card::before{
  content:'';position:absolute;
  top:0;left:0;width:3px;height:100%;
  /* set per category via inline style */
}
/* hot badge */
.hot-badge{
  position:absolute;top:10px;right:10px;
  font-size:11px;font-weight:600;color:var(--hot);
  background:var(--hot-bg);border-radius:12px;padding:2px 8px;
  white-space:nowrap;
}
/* meta row */
.card-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:7px}
.card-cat{font-size:11px;font-weight:600;letter-spacing:.06em}
.card-date{font-size:11px;color:var(--text-dim)}
/* title */
.card h3{font-size:15px;font-weight:600;color:#fff;line-height:1.35;margin-bottom:8px}
/* summary */
.card p{font-size:13px;color:var(--text-dim);line-height:1.55;margin-bottom:12px}
/* tags */
.card-tags{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:14px}
.card-tags span{
  font-size:11px;color:var(--text-dim);
  background:rgba(255,255,255,.06);border-radius:4px;padding:2px 8px;
}
/* footer */
.card-foot{
  display:flex;justify-content:space-between;align-items:center;
  border-top:1px solid var(--border);padding-top:10px;
}
.card-source{font-size:11px;color:#4a5568}
.read-link{
  font-size:12px;font-weight:500;color:var(--accent);
  transition:color .2s;
}
.read-link:hover{color:#fff}

/* â”€â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar{display:flex;flex-direction:column;gap:16px}

/* shared side-card */
.side-card{
  background:var(--bg-card);
  border:1px solid var(--border);border-radius:14px;padding:18px;
}
.side-card h3{
  font-size:14px;font-weight:600;color:#fff;
  display:flex;align-items:center;gap:6px;margin-bottom:12px;
}

/* â”€â”€ HOT LIST â”€â”€ */
.hot-list{display:flex;flex-direction:column;gap:2px}
.hot-item{
  display:flex;align-items:flex-start;gap:10px;
  padding:7px 0;border-bottom:1px solid var(--border);
  transition:opacity .2s;
}
.hot-item:last-child{border-bottom:none}
.hot-item:hover{opacity:.75}
.hot-rank{
  font-size:13px;font-weight:700;color:var(--accent);
  width:18px;flex-shrink:0;text-align:center;padding-top:1px;
}
.hot-title{font-size:13px;color:#c8cdd8;line-height:1.4}

/* â”€â”€ XHS GENERATOR â”€â”€ */
.xhs-head{display:flex;justify-content:space-between;align-items:center}
.xhs-toggle{
  font-size:12px;color:var(--accent);font-weight:500;
  background:var(--accent-glow);border:1px solid var(--accent-border);
  border-radius:14px;padding:3px 13px;transition:background .2s;
}
.xhs-toggle:hover{background:rgba(125,211,252,.26)}
.xhs-desc{font-size:12px;color:var(--text-dim);line-height:1.5;margin-bottom:10px}
.xhs-body{
  display:none;
  background:rgba(0,0,0,.3);border:1px solid var(--border);
  border-radius:10px;overflow:hidden;
  animation:fadeDown .3s ease;
}
.xhs-body.open{display:block}
@keyframes fadeDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.xhs-pre{
  padding:15px 17px;font-size:13px;color:#b8bec9;
  line-height:1.65;white-space:pre-wrap;word-break:break-word;
  max-height:380px;overflow-y:auto;
}
.xhs-actions{
  padding:10px 17px;border-top:1px solid var(--border);
  display:flex;justify-content:center;gap:10px;
}
.copy-btn{
  background:linear-gradient(135deg,#7dd3fc,#60a5fa);
  border-radius:8px;color:#0b0d13;font-weight:700;font-size:13px;
  padding:8px 26px;letter-spacing:.04em;
  transition:filter .2s,transform .1s;
}
.copy-btn:hover{filter:brightness(1.15)}
.copy-btn:active{transform:scale(.96)}
.copy-btn.done{background:linear-gradient(135deg,#4ade80,#22c55e)}

/* â”€â”€ DOUYIN VIDEO GENERATOR â”€â”€ */
.dyt-head{display:flex;justify-content:space-between;align-items:center}
.dyt-toggle{
  font-size:12px;color:#fb7185;font-weight:500;
  background:rgba(251,113,133,.12);border:1px solid rgba(251,113,133,.28);
  border-radius:14px;padding:3px 13px;transition:background .2s;
}
.dyt-toggle:hover{background:rgba(251,113,133,.22)}
.dyt-desc{font-size:12px;color:var(--text-dim);line-height:1.5;margin-bottom:12px}

.dyt-body{display:none;animation:fadeDown .3s ease}
.dyt-body.open{display:block}

/* options row */
.dyt-options{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:14px}
.dyt-opt-label{font-size:11px;color:var(--text-dim);width:100%;margin-bottom:2px}
.dyt-opt-group{display:flex;gap:6px;flex-wrap:wrap}
.dyt-chip{
  font-size:11.5px;padding:4px 11px;border-radius:16px;
  background:rgba(255,255,255,.05);border:1px solid var(--border);
  color:var(--text-dim);transition:all .18s;
}
.dyt-chip:hover{border-color:var(--border-strong);color:var(--text)}
.dyt-chip.sel{
  background:rgba(251,113,133,.14);border-color:rgba(251,113,133,.35);color:#fb7185;
}

/* generate btn */
.dyt-gen-btn{
  width:100%;padding:9px;border-radius:9px;font-size:13px;font-weight:600;
  background:linear-gradient(135deg,#fb7185,#e11d48);
  color:#fff;letter-spacing:.03em;
  transition:filter .2s,transform .1s;margin-bottom:14px;
}
.dyt-gen-btn:hover{filter:brightness(1.12)}
.dyt-gen-btn:active{transform:scale(.97)}
.dyt-gen-btn:disabled{filter:brightness(.55);cursor:not-allowed;transform:none}

/* generating overlay */
.dyt-generating{
  display:none;flex-direction:column;align-items:center;gap:10px;
  padding:24px 0;
}
.dyt-generating.show{display:flex}
.dyt-spinner{
  width:36px;height:36px;border:3px solid rgba(251,113,133,.25);
  border-top-color:#fb7185;border-radius:50%;
  animation:spin .7s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
.dyt-gen-status{font-size:12px;color:var(--text-dim)}
.dyt-gen-pct{font-size:11px;color:#fb7185;font-weight:600}

/* preview viewport  â€“ 9:16 portrait card */
.dyt-preview-wrap{display:none;flex-direction:column;gap:10px}
.dyt-preview-wrap.show{display:flex}
.dyt-viewport{
  width:100%;aspect-ratio:9/16;max-height:380px;
  border-radius:12px;overflow:hidden;
  background:#000;position:relative;
  border:1px solid var(--border);
}
.dyt-viewport canvas{width:100%;height:100%;display:block}
/* play-pause overlay */
.dyt-play-overlay{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,.18);opacity:0;
  transition:opacity .2s;pointer-events:none;
}
.dyt-viewport:hover .dyt-play-overlay{opacity:1;pointer-events:auto}
.dyt-play-btn{
  width:44px;height:44px;border-radius:50%;
  background:rgba(0,0,0,.55);backdrop-filter:blur(4px);
  display:flex;align-items:center;justify-content:center;
  border:2px solid rgba(255,255,255,.35);
  transition:background .2s;
}
.dyt-play-btn:hover{background:rgba(0,0,0,.75)}
.dyt-play-btn svg{width:18px;height:18px;fill:#fff;margin-left:2px}
.dyt-play-btn.playing svg{margin-left:0}

/* progress bar */
.dyt-progress-track{
  width:100%;height:3px;background:rgba(255,255,255,.1);
  border-radius:2px;overflow:hidden;
}
.dyt-progress-fill{
  height:100%;width:0%;background:linear-gradient(90deg,#fb7185,#f43f5e);
  border-radius:2px;transition:width .15s linear;
}

/* action buttons row */
.dyt-actions{display:flex;gap:8px}
.dyt-dl-btn{
  flex:1;padding:8px;border-radius:8px;font-size:12.5px;font-weight:600;
  background:linear-gradient(135deg,#fb7185,#e11d48);color:#fff;
  transition:filter .2s,transform .1s;
}
.dyt-dl-btn:hover{filter:brightness(1.12)}
.dyt-dl-btn:active{transform:scale(.96)}
.dyt-dl-btn.done{background:linear-gradient(135deg,#4ade80,#22c55e)}

.dyt-cp-btn{
  flex:1;padding:8px;border-radius:8px;font-size:12.5px;font-weight:600;
  background:rgba(255,255,255,.07);border:1px solid var(--border);color:var(--text);
  transition:filter .2s,transform .1s;
}
.dyt-cp-btn:hover{filter:brightness(1.15)}
.dyt-cp-btn:active{transform:scale(.96)}
.dyt-cp-btn.done{background:rgba(134,239,172,.15);border-color:rgba(134,239,172,.35);color:#86efac}

/* â”€â”€ TAG CLOUD â”€â”€ */
.tag-cloud{display:flex;flex-wrap:wrap;gap:6px}
.tag{
  font-size:12px;color:var(--accent);
  background:var(--accent-glow);border:1px solid var(--accent-border);
  border-radius:14px;padding:3px 11px;cursor:pointer;
  transition:background .2s;
}
.tag:hover{background:rgba(125,211,252,.28)}

/* â”€â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
footer{
  position:relative;z-index:1;
  border-top:1px solid var(--border);padding:18px 28px;text-align:center;
}
footer p{font-size:11px;color:#4a5568}

/* â”€â”€â”€ SCROLLBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,.12);border-radius:3px}

/* â”€â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media(max-width:900px){
  .main-layout{grid-template-columns:1fr}
  .sidebar{order:-1}
}
@media(max-width:560px){
  .shell{padding:0 16px}
  .header-inner{flex-direction:column;align-items:flex-start}
  .stats-row{gap:16px}
  .cards-grid{grid-template-columns:1fr}
  .logo-text h1{font-size:24px}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header>
<div class="shell">
<div class="header-inner">
  <div class="logo">
    <span class="logo-diamond">â—†</span>
    <div class="logo-text">
      <h1>AI DAILY</h1>
      <p>æ¯æ—¥ AI ä¸–ç•ŒåŠ¨æ€æ±‡æ€»</p>
    </div>
  </div>
  <div style="display:flex;align-items:center;gap:22px;flex-wrap:wrap">
    <div class="stats-row">
      <div class="stat"><span class="stat-val" id="statTotal">20</span><span class="stat-lbl">èµ„è®¯æ•°</span></div>
      <div class="stat"><span class="stat-val" id="statTools">8</span><span class="stat-lbl">å·¥å…·æ•°</span></div>
      <div class="stat"><span class="stat-val" id="statHot">9</span><span class="stat-lbl">çƒ­ç‚¹æ•°</span></div>
    </div>
    <div class="live-badge">
      <span class="live-dot"></span>
      <span id="liveTime">å·²æ›´æ–° â€¦</span>
    </div>
  </div>
</div>
</div>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTROLS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="shell">
<div class="controls">
  <div class="search-wrap">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
    <input type="text" id="searchInput" placeholder="æœç´¢èµ„è®¯ã€å·¥å…·ã€æ ‡ç­¾â€¦" autocomplete="off">
  </div>
  <div class="cat-row" id="catRow">
    <!-- injected by JS -->
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="shell">
<div class="main-layout">

  <!-- LEFT: cards -->
  <section>
    <div class="section-head">
      <h2><span class="accent-dash">â€”</span> ä»Šæ—¥æ±‡æ€»</h2>
      <span class="item-count" id="itemCount">20 é¡¹</span>
    </div>
    <div class="cards-grid" id="cardsGrid">
      <!-- injected by JS -->
    </div>
  </section>

  <!-- RIGHT: sidebar -->
  <aside class="sidebar">

    <!-- hot list -->
    <div class="side-card">
      <h3>ğŸ”¥ ä»Šæ—¥ TOP çƒ­ç‚¹</h3>
      <div class="hot-list" id="hotList"></div>
    </div>

    <!-- XHS generator -->
    <div class="side-card">
      <div class="xhs-head">
        <h3 style="margin-bottom:0">ğŸ“ å°çº¢ä¹¦ç¬”è®°ç”Ÿæˆ</h3>
        <button class="xhs-toggle" id="xhsToggle">å±•å¼€</button>
      </div>
      <p class="xhs-desc">æ¯æ—¥è‡ªåŠ¨æ ¹æ®æ±‡æ€»å†…å®¹ç”Ÿæˆå°çº¢ä¹¦ç¬”è®°ï¼Œä¸€é”®å¤åˆ¶å³å¯å‘å¸ƒã€‚</p>
      <div class="xhs-body" id="xhsBody">
        <pre class="xhs-pre" id="xhsPre"></pre>
        <div class="xhs-actions">
          <button class="copy-btn" id="copyBtn">ğŸ“‹ å¤åˆ¶ç¬”è®°</button>
        </div>
      </div>
    </div>

    <!-- DOUYIN VIDEO GENERATOR -->
    <div class="side-card">
      <div class="dyt-head">
        <h3 style="margin-bottom:0">ğŸ¬ æŠ–éŸ³è§†é¢‘ç”Ÿæˆ</h3>
        <button class="dyt-toggle" id="dytToggle">å±•å¼€</button>
      </div>
      <p class="dyt-desc">æ ¹æ®ä»Šæ—¥çƒ­ç‚¹è‡ªåŠ¨ç”Ÿæˆ 9:16 ç«–å±çŸ­è§†é¢‘ï¼Œå¯ç›´æ¥ä¸‹è½½å‘å¸ƒåˆ°æŠ–éŸ³ã€‚</p>
      <div class="dyt-body" id="dytBody">

        <!-- options -->
        <div class="dyt-options">
          <div>
            <div class="dyt-opt-label">ğŸ“Œ çƒ­ç‚¹æ•°é‡</div>
            <div class="dyt-opt-group" id="dytCountGroup">
              <button class="dyt-chip sel" data-val="3">Top 3</button>
              <button class="dyt-chip" data-val="5">Top 5</button>
              <button class="dyt-chip" data-val="7">Top 7</button>
            </div>
          </div>
          <div>
            <div class="dyt-opt-label">â±ï¸ æ¯é¡µåœç•™</div>
            <div class="dyt-opt-group" id="dytDurGroup">
              <button class="dyt-chip sel" data-val="3">3 ç§’</button>
              <button class="dyt-chip" data-val="4">4 ç§’</button>
              <button class="dyt-chip" data-val="5">5 ç§’</button>
            </div>
          </div>
        </div>

        <!-- generate -->
        <button class="dyt-gen-btn" id="dytGenBtn">âš¡ ç”Ÿæˆè§†é¢‘</button>

        <!-- generating spinner -->
        <div class="dyt-generating" id="dytGenerating">
          <div class="dyt-spinner"></div>
          <div class="dyt-gen-status" id="dytGenStatus">æ­£åœ¨ç”Ÿæˆè§†é¢‘â€¦</div>
          <div class="dyt-gen-pct" id="dytGenPct">0%</div>
        </div>

        <!-- preview + controls -->
        <div class="dyt-preview-wrap" id="dytPreviewWrap">
          <div class="dyt-viewport">
            <canvas id="dytCanvas"></canvas>
            <div class="dyt-play-overlay">
              <button class="dyt-play-btn" id="dytPlayBtn">
                <!-- play icon (default) -->
                <svg id="dytPlayIcon" viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"/></svg>
              </button>
            </div>
          </div>
          <div class="dyt-progress-track"><div class="dyt-progress-fill" id="dytProgressFill"></div></div>
          <div class="dyt-actions">
            <button class="dyt-dl-btn" id="dytDlBtn">â¬‡ï¸ ä¸‹è½½è§†é¢‘</button>
            <button class="dyt-cp-btn" id="dytCpBtn">ğŸ“‹ å¤åˆ¶è„šæœ¬</button>
          </div>
        </div>

      </div><!-- /dyt-body -->
    </div>

    <!-- tag cloud -->
    <div class="side-card">
      <h3>ğŸ·ï¸ çƒ­é—¨æ ‡ç­¾</h3>
      <div class="tag-cloud" id="tagCloud"></div>
    </div>

  </aside>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<footer>
<p>AI DAILY Â· æ•°æ®æ¥æºï¼šTechCrunch / MIT Technology Review / IBM Think / Crescendo AI / DataNorth AI ç­‰ Â· æ¯æ—¥è‡ªåŠ¨æ›´æ–° Â· å†…å®¹ä»…ä¾›å‚è€ƒ</p>
</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATA + LOGIC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let NEWS = [];  // å°†ä» news_data.json åŠ¨æ€åŠ è½½

/* â”€â”€â”€ åŠ¨æ€åŠ è½½æ–°é—»æ•°æ® â”€â”€â”€ */
async function loadNewsData() {
  try {
    // æ·»åŠ æ—¶é—´æˆ³å‚æ•°ï¼Œé˜²æ­¢ç¼“å­˜
    const timestamp = new Date().getTime();
    const response = await fetch(`news_data.json?t=${timestamp}`);
    
    if (!response.ok) throw new Error('æ— æ³•åŠ è½½æ•°æ®');
    
    const data = await response.json();
    NEWS = data.articles || [];

    // æ›´æ–°é¡µé¢ä¸Šçš„"å·²æ›´æ–°æ—¶é—´"
    if (data.last_update) {
      const updateDate = new Date(data.last_update);
      document.getElementById('liveTime').textContent = 
        `å·²æ›´æ–° ${updateDate.toLocaleString('zh-CN', { 
          month: 'numeric', 
          day: 'numeric', 
          hour: '2-digit', 
          minute: '2-digit' 
        })}`;
    }
    
    // GitHub Pages è·¯å¾„å…¼å®¹
    const basePath = window.location.pathname.includes('/ai-daily-site') 
      ? '/ai-daily-site' 
      : '';
    const response = await fetch(`${basePath}/news_data.json`);
    if (!response.ok) throw new Error('æ— æ³•åŠ è½½æ•°æ®');
    
    const data = await response.json();
    NEWS = data.articles || [];
    
    console.log(`âœ“ æˆåŠŸåŠ è½½ ${NEWS.length} ç¯‡æ–°é—»`);
    console.log(`ğŸ“… æœ€åæ›´æ–°: ${data.last_update || 'æœªçŸ¥'}`);
    
    if (data.last_update) {
      const updateDate = new Date(data.last_update);
      document.getElementById('liveTime').textContent = 
        `å·²æ›´æ–° ${updateDate.toLocaleString('zh-CN', { 
          month: 'numeric', 
          day: 'numeric', 
          hour: '2-digit', 
          minute: '2-digit' 
        })}`;
    }
    
    return true;
  } catch (error) {
    console.warn('âš ï¸ åŠ è½½ news_data.json å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®');
    
    NEWS = [
      {id:1,cat:'news',hot:true,
       title:'2026ï¼šAI ä»ç‚’ä½œèµ°å‘åŠ¡å®',
       summary:'è¡Œä¸šé‡å¿ƒä»å¤§å‹è¯­è¨€æ¨¡å‹è½¬å‘å®é™…éƒ¨ç½²ã€‚å°æ¨¡å‹ã€è¾¹ç¼˜æ™ºèƒ½æˆä¸ºç„¦ç‚¹ï¼Œæ™ºèƒ½ä½“åº”ç”¨å¿«é€Ÿè½åœ°ã€‚',
       source:'TechCrunch',date:'2026-02-03',
       url:'https://techcrunch.com/',
       tags:['æ™ºèƒ½ä½“','è¡Œä¸šè¶‹åŠ¿']},

      {id:2,cat:'tools',hot:true,
       title:'ChatGPT 5.2ï¼šæ·±åº¦æ¨ç† + è‡ªä¸»æ‰§è¡Œ',
       summary:'GPT 5.2 æ•´åˆäº†æ·±åº¦æ¨ç†ã€é•¿æœŸè®°å¿†å’Œè‡ªä¸»ä»»åŠ¡æ‰§è¡Œèƒ½åŠ›ï¼Œæ”¯æŒå¤æ‚åœºæ™¯åº”ç”¨ã€‚',
       source:'OpenAI',date:'2026-02-01',
       url:'https://openai.com/',
       tags:['ChatGPT','æ¨ç†æ¨¡å‹']},

      {id:3,cat:'research',hot:true,
       title:'ä¸–ç•Œæ¨¡å‹ï¼šä¸‹ä¸€ä»£ AI çªç ´æ–¹å‘',
       summary:'å¤šå®¶å…¬å¸æ­£åœ¨å¼€å‘èƒ½å¤Ÿåœ¨ 3D ç©ºé—´ä¸­ç†è§£ç‰©ç†è§„å¾‹çš„ AI ä¸–ç•Œæ¨¡å‹ã€‚',
       source:'TechCrunch',date:'2026-02-02',
       url:'https://techcrunch.com/',
       tags:['ä¸–ç•Œæ¨¡å‹','ç ”ç©¶']},

      {id:4,cat:'industry',hot:false,
       title:'æ•°æ®ä¸­å¿ƒæ”¯å‡ºè¶… 5000 äº¿ç¾å…ƒ',
       summary:'é¡¶çº§ç§‘æŠ€å…¬å¸æ•°æ®ä¸­å¿ƒèµ„æœ¬æ”¯å‡ºé¢„è®¡çªç ´ 5000 äº¿ç¾å…ƒã€‚',
       source:'Bloomberg',date:'2026-02-02',
       url:'https://bloomberg.com/',
       tags:['æŠ•èµ„','åŸºç¡€è®¾æ–½']},

      {id:5,cat:'safety',hot:false,
       title:'AI ç›‘ç®¡æ³•æ¡ˆå¯†é›†è½åœ°',
       summary:'å¤šä¸ªå›½å®¶å’Œåœ°åŒºæ¨è¿› AI æ²»ç†ç«‹æ³•ï¼Œä»æ¦‚å¿µèµ°å‘æ‰§è¡Œã€‚',
       source:'Reuters',date:'2026-01-15',
       url:'https://reuters.com/',
       tags:['AIæ²»ç†','æ³•è§„']},
    ];
    
    return false;
  }
}

/* â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

/* â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let activeCat = 'all';
let searchVal = '';

/* â”€â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function filtered(){
  return NEWS.filter(item => {
    const matchCat = activeCat === 'all' || item.cat === activeCat;
    const q = searchVal.trim().toLowerCase();
    const matchQ = !q ||
      item.title.toLowerCase().includes(q) ||
      item.summary.toLowerCase().includes(q) ||
      item.tags.some(t => t.toLowerCase().includes(q));
    return matchCat && matchQ;
  });
}

function catLabel(id){ return CATS.find(c=>c.id===id)?.label || id; }
function catCount(id){ return id==='all' ? NEWS.length : NEWS.filter(i=>i.cat===id).length; }

/* â”€â”€â”€ XHS NOTE GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function generateXHS(){
  const today = new Date().toLocaleDateString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit'});
  const hot   = NEWS.filter(i=>i.hot).slice(0,5);
  const tools = NEWS.filter(i=>i.cat==='tools').slice(0,3);
  const res   = NEWS.filter(i=>i.cat==='research').slice(0,2);
  const ranks = ['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰','â‘£','â‘¤'];

  let n = `ğŸ¤– AIæ—¥æŠ¥ | ${today}\n`;
  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  n += `âœ¨ ä»Šæ—¥å¿…çœ‹ TOPçƒ­ç‚¹\n\n`;
  hot.forEach((item,i) => { n += `${ranks[i]} ${item.title}\nâ†’ ${item.summary}\n\n`; });

  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
  n += `ğŸ› ï¸ ä»Šæ—¥å·¥å…·æ¨è\n\n`;
  tools.forEach(item => { n += `ğŸ’ ${item.title}\n${item.summary}\n\n`; });

  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
  n += `ğŸ”¬ å‰æ²¿ç ”ç©¶ä¸€ç¥\n\n`;
  res.forEach(item => { n += `ğŸ“Œ ${item.title}\n${item.summary}\n\n`; });

  n += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
  n += `ğŸ’¡ ä»Šæ—¥ AI é‡‘å¥\n`;
  n += `"2026 ä¸æ˜¯ AI çš„ç»ˆç»“ï¼Œè€Œæ˜¯å®ƒä»ç‚’ä½œèµ°å‘åŠ¡å®çš„èµ·ç‚¹ã€‚"\n\n`;
  n += `ğŸ”— æ›´å¤šè¯¦æƒ…è®¿é—® AI Daily æ±‡æ€»ç«™\n`;
  n += `#AIæ—¥æŠ¥ #äººå·¥æ™ºèƒ½ #AIå·¥å…· #ç§‘æŠ€èµ„è®¯ #å°çº¢ä¹¦`;
  return n;
}

/* â”€â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderCatBar(){
  const el = document.getElementById('catRow');
  el.innerHTML = CATS.map(c => `
    <button class="cat-btn ${c.id===activeCat?'active':''}" data-cat="${c.id}">
      <span>${c.icon}</span>${c.label}
      <span class="cnt">${catCount(c.id)}</span>
    </button>`).join('');
  el.querySelectorAll('.cat-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      activeCat = btn.dataset.cat;
      renderAll();
    });
  });
}

function renderCards(){
  const items = filtered();
  document.getElementById('itemCount').textContent = items.length + ' é¡¹';

  const grid = document.getElementById('cardsGrid');
  grid.innerHTML = items.map((item,idx) => `
    <article class="card" style="--stripe:${CAT_COLOR[item.cat]};animation-delay:${idx*80}ms" data-idx="${idx}">
      <style>.card[data-idx="${idx}"]::before{background:${CAT_COLOR[item.cat]}}</style>
      ${item.hot ? '<span class="hot-badge">ğŸ”¥ çƒ­ç‚¹</span>' : ''}
      <div class="card-meta">
        <span class="card-cat" style="color:${CAT_COLOR[item.cat]}">${catLabel(item.cat)}</span>
        <span class="card-date">${item.date}</span>
      </div>
      <h3>${item.title}</h3>
      <p>${item.summary}</p>
      <div class="card-tags">${item.tags.map(t=>`<span>${t}</span>`).join('')}</div>
      <div class="card-foot">
        <span class="card-source">æ¥æºï¼š${item.source}</span>
        <a href="${item.url}" target="_blank" rel="noopener" class="read-link">æŸ¥çœ‹åŸæ–‡ â†’</a>
      </div>
    </article>`).join('');

  // stagger visibility
  requestAnimationFrame(() => {
    grid.querySelectorAll('.card').forEach((card,i) => {
      setTimeout(() => card.classList.add('visible'), i * 75);
    });
  });
}

function renderHotList(){
  const hots = NEWS.filter(i=>i.hot).slice(0,6);
  document.getElementById('hotList').innerHTML = hots.map((item,i) => `
    <a href="${item.url}" target="_blank" rel="noopener" class="hot-item">
      <span class="hot-rank">${i+1}</span>
      <span class="hot-title">${item.title}</span>
    </a>`).join('');
}

function renderTagCloud(){
  const tags = [...new Set(NEWS.flatMap(i=>i.tags))];
  const el = document.getElementById('tagCloud');
  el.innerHTML = tags.map(t => `<span class="tag" data-tag="${t}">#${t}</span>`).join('');
  el.querySelectorAll('.tag').forEach(span => {
    span.addEventListener('click', () => {
      searchVal = span.dataset.tag;
      document.getElementById('searchInput').value = searchVal;
      renderAll();
    });
  });
}

function renderXHS(){
  document.getElementById('xhsPre').textContent = generateXHS();
}

function renderStats(){
  document.getElementById('statTotal').textContent = NEWS.length;
  document.getElementById('statTools').textContent = NEWS.filter(i=>i.cat==='tools').length;
  document.getElementById('statHot').textContent  = NEWS.filter(i=>i.hot).length;
}

function renderAll(){
  renderCatBar();
  renderCards();
  renderHotList();
  renderTagCloud();
  renderXHS();
  renderStats();
}

/* â”€â”€â”€ SEARCH LISTENER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('searchInput').addEventListener('input', e => {
  searchVal = e.target.value;
  renderAll();
});

/* â”€â”€â”€ XHS TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('xhsToggle').addEventListener('click', function(){
  const body = document.getElementById('xhsBody');
  const open = body.classList.toggle('open');
  this.textContent = open ? 'æ”¶èµ·' : 'å±•å¼€';
});

/* â”€â”€â”€ COPY BTN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('copyBtn').addEventListener('click', function(){
  const text = document.getElementById('xhsPre').textContent;
  navigator.clipboard.writeText(text).then(() => {
    this.textContent = 'âœ“ å·²å¤åˆ¶ï¼';
    this.classList.add('done');
    setTimeout(() => {
      this.textContent = 'ğŸ“‹ å¤åˆ¶ç¬”è®°';
      this.classList.remove('done');
    }, 2200);
  });
});

/* â”€â”€â”€ DOUYIN VIDEO GENERATOR ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function(){
  /* â”€â”€ chip toggle helper â”€â”€ */
  function chipGroup(containerId, cb){
    const el = document.getElementById(containerId);
    el.querySelectorAll('.dyt-chip').forEach(btn => {
      btn.addEventListener('click', function(){
        el.querySelectorAll('.dyt-chip').forEach(b=>b.classList.remove('sel'));
        this.classList.add('sel');
        cb(this.dataset.val);
      });
    });
  }

  let dytCount = 3, dytDur = 3;
  chipGroup('dytCountGroup', v => { dytCount = +v; });
  chipGroup('dytDurGroup',   v => { dytDur   = +v; });

  /* â”€â”€ toggle â”€â”€ */
  document.getElementById('dytToggle').addEventListener('click', function(){
    const body = document.getElementById('dytBody');
    const open = body.classList.toggle('open');
    this.textContent = open ? 'æ”¶èµ·' : 'å±•å¼€';
  });

  /* â”€â”€â”€ SLIDE DATA BUILDER â”€â”€â”€ */
  function buildSlides(){
    const today = new Date().toLocaleDateString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit'});
    const hotItems = NEWS.filter(i=>i.hot).slice(0, dytCount);
    const slides = [];

    /* intro slide */
    slides.push({
      type:'intro',
      title:'ğŸ¤– AI æ—¥æŠ¥',
      subtitle: today,
      footer:'æ¯æ—¥æ™ºèƒ½èµ„è®¯æ±‡æ€»'
    });

    /* one slide per hot item */
    hotItems.forEach((item,i) => {
      slides.push({
        type:'item',
        rank: i+1,
        cat: item.cat,
        title: item.title,
        summary: item.summary,
        source: item.source
      });
    });

    /* outro */
    slides.push({
      type:'outro',
      title:'æ›´å¤šèµ„è®¯',
      subtitle:'è®¿é—® AI DAILY æ±‡æ€»ç«™',
      footer:'#AIæ—¥æŠ¥ #äººå·¥æ™ºèƒ½ #æŠ–éŸ³'
    });

    return slides;
  }

  /* â”€â”€â”€ TEXT WRAP UTIL â”€â”€â”€ */
  function wrapText(ctx, text, x, y, maxW, lineH){
    const words = text.split('');
    let line = '', lines = [];
    for(const ch of words){
      const test = line + ch;
      if(ctx.measureText(test).width > maxW && line){
        lines.push(line); line = ch;
      } else { line = test; }
    }
    if(line) lines.push(line);
    lines.forEach((l,i) => ctx.fillText(l, x, y + i*lineH));
    return lines.length;
  }

  /* â”€â”€â”€ CANVAS FRAME RENDERER â”€â”€â”€ */
  const CAT_COLORS_HEX = {
    news:'#7dd3fc', tools:'#86efac', research:'#c4b5fd',
    industry:'#fcd34d', safety:'#fca5a5'
  };
  const CAT_LABELS = {
    news:'è¡Œä¸šåŠ¨æ€', tools:'AI å·¥å…·', research:'ç ”ç©¶å‰æ²¿',
    industry:'å•†ä¸šåº”ç”¨', safety:'å®‰å…¨ä¸ä¼¦ç†'
  };

  function drawFrame(ctx, W, H, slide, progress){
    /* â”€â”€ background â”€â”€ */
    const grad = ctx.createLinearGradient(0,0,W,H);
    grad.addColorStop(0,'#0f1118');
    grad.addColorStop(1,'#1a1d27');
    ctx.fillStyle = grad;
    ctx.fillRect(0,0,W,H);

    /* â”€â”€ animated accent stripe (top) â”€â”€ */
    const stripeY = 0;
    const stripeH = 6;
    const sg = ctx.createLinearGradient(0,0,W,0);
    sg.addColorStop(0,'#7dd3fc');
    sg.addColorStop(.5,'#fb7185');
    sg.addColorStop(1,'#c4b5fd');
    ctx.fillStyle = sg;
    ctx.fillRect(0,stripeY,W,stripeH);

    /* â”€â”€ subtle grid dots â”€â”€ */
    ctx.fillStyle = 'rgba(255,255,255,0.035)';
    for(let gx=30; gx<W; gx+=36){
      for(let gy=40; gy<H; gy+=36){
        ctx.beginPath(); ctx.arc(gx,gy,1.5,0,Math.PI*2); ctx.fill();
      }
    }

    if(slide.type === 'intro' || slide.type === 'outro'){
      drawIntroOutro(ctx,W,H,slide);
    } else {
      drawItemSlide(ctx,W,H,slide);
    }

    /* â”€â”€ progress dots â”€â”€ */
    // handled outside
  }

  function drawIntroOutro(ctx,W,H,slide){
    const cx = W/2;
    /* big icon circle */
    ctx.beginPath();
    ctx.arc(cx, H*.38, 52, 0, Math.PI*2);
    ctx.fillStyle = 'rgba(125,211,252,0.1)';
    ctx.fill();
    ctx.strokeStyle = '#7dd3fc';
    ctx.lineWidth = 2;
    ctx.stroke();

    /* icon text */
    ctx.fillStyle='#fff';
    ctx.font = 'bold 36px sans-serif';
    ctx.textAlign='center';
    ctx.textBaseline='middle';
    ctx.fillText(slide.type==='intro'?'ğŸ¤–':'âœ¨', cx, H*.38);

    /* title */
    ctx.fillStyle='#fff';
    ctx.font = 'bold 26px "Noto Sans SC",sans-serif';
    ctx.fillText(slide.title, cx, H*.52);

    /* subtitle */
    ctx.fillStyle='#7dd3fc';
    ctx.font = '16px "Noto Sans SC",sans-serif';
    ctx.fillText(slide.subtitle, cx, H*.58);

    /* footer */
    ctx.fillStyle='rgba(255,255,255,0.4)';
    ctx.font = '13px "Noto Sans SC",sans-serif';
    ctx.fillText(slide.footer, cx, H*.68);
  }

  function drawItemSlide(ctx,W,H,slide){
    const pad = 28;
    const color = CAT_COLORS_HEX[slide.cat] || '#7dd3fc';

    /* rank badge */
    ctx.beginPath();
    ctx.arc(pad+24, 60, 24, 0, Math.PI*2);
    ctx.fillStyle = color+'33';
    ctx.fill();
    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.fillStyle='#fff';
    ctx.font='bold 18px sans-serif';
    ctx.textAlign='center';
    ctx.textBaseline='middle';
    ctx.fillText('#'+slide.rank, pad+24, 60);

    /* category label */
    const catLbl = CAT_LABELS[slide.cat]||slide.cat;
    ctx.fillStyle = color;
    ctx.font = 'bold 13px "Noto Sans SC",sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText(catLbl, pad+58, 64);

    /* accent line under rank row */
    ctx.fillStyle = color;
    ctx.fillRect(pad, 94, W-pad*2, 2);

    /* title */
    ctx.fillStyle='#fff';
    ctx.font='bold 21px "Noto Sans SC",sans-serif';
    ctx.textBaseline='top';
    const tLines = wrapText(ctx, slide.title, pad, 116, W-pad*2, 30);

    /* summary */
    ctx.fillStyle='rgba(221,224,232,0.82)';
    ctx.font='15px "Noto Sans SC",sans-serif';
    const sumTop = 116 + tLines*30 + 18;
    wrapText(ctx, slide.summary, pad, sumTop, W-pad*2, 24);

    /* source tag at bottom */
    const srcY = H - 72;
    ctx.fillStyle='rgba(255,255,255,0.15)';
    const srcTxt = 'æ¥æºï¼š'+slide.source;
    ctx.font='12px "Noto Sans SC",sans-serif';
    const srcW = ctx.measureText(srcTxt).width + 20;
    roundRect(ctx, pad, srcY, srcW, 28, 6);
    ctx.fill();
    ctx.fillStyle='rgba(255,255,255,0.5)';
    ctx.textBaseline='middle';
    ctx.fillText(srcTxt, pad+10, srcY+14);
  }

  function roundRect(ctx,x,y,w,h,r){
    ctx.beginPath();
    ctx.moveTo(x+r,y);
    ctx.lineTo(x+w-r,y);
    ctx.quadraticCurveTo(x+w,y,x+w,y+r);
    ctx.lineTo(x+w,y+h-r);
    ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);
    ctx.lineTo(x+r,y+h);
    ctx.quadraticCurveTo(x,y+h,x,y+h-r);
    ctx.lineTo(x,y+r);
    ctx.quadraticCurveTo(x,y,x+r,y);
    ctx.closePath();
  }

  /* â”€â”€â”€ PROGRESS DOTS (slide indicators) â”€â”€â”€ */
  function drawProgressDots(ctx,W,H,slides,currentIdx){
    const total = slides.length;
    const dotR = 4;
    const gap  = 10;
    const totalW = total*(dotR*2) + (total-1)*gap;
    let startX = (W - totalW)/2;
    const dotY = H - 24;
    slides.forEach((_,i) => {
      ctx.beginPath();
      ctx.arc(startX + dotR, dotY, dotR, 0, Math.PI*2);
      ctx.fillStyle = i===currentIdx ? '#fb7185' : 'rgba(255,255,255,0.2)';
      ctx.fill();
      startX += dotR*2 + gap;
    });
  }

  /* â”€â”€â”€ RECORDING + PLAYBACK STATE â”€â”€â”€ */
  let slides        = [];
  let videoBlob     = null;
  let videoURL      = null;
  let isPlaying     = false;
  let rafId         = null;
  let playStartTime = 0;
  let playElapsed   = 0;

  const canvas    = document.getElementById('dytCanvas');
  const ctx       = canvas.getContext('2d');
  const genBtn    = document.getElementById('dytGenBtn');
  const genWrap   = document.getElementById('dytGenerating');
  const genStatus = document.getElementById('dytGenStatus');
  const genPct    = document.getElementById('dytGenPct');
  const prevWrap  = document.getElementById('dytPreviewWrap');
  const progFill  = document.getElementById('dytProgressFill');
  const playBtn   = document.getElementById('dytPlayBtn');
  const dlBtn     = document.getElementById('dytDlBtn');
  const cpBtn     = document.getElementById('dytCpBtn');

  /* â”€â”€â”€ GENERATE â”€â”€â”€ */
  genBtn.addEventListener('click', async function(){
    genBtn.disabled = true;
    prevWrap.classList.remove('show');
    genWrap.classList.add('show');
    genPct.textContent   = '0%';
    genStatus.textContent = 'æ­£åœ¨ç”Ÿæˆè§†é¢‘â€¦';

    slides = buildSlides();
    const W = 1080, H = 1920;

    /* â”€â”€ off-screen canvas â”€â”€ */
    const offscreen = document.createElement('canvas');
    offscreen.width  = W;
    offscreen.height = H;
    const octx = offscreen.getContext('2d');

    /* draw the very first frame BEFORE captureStream â€” required by some browsers */
    drawFrame(octx, W, H, slides[0], 0);
    drawProgressDots(octx, W, H, slides, 0);

    /* â”€â”€ pick best supported mime â”€â”€ */
    const mimeTypes = [
      'video/webm;codecs=vp9',
      'video/webm;codecs=vp8',
      'video/webm',
      'video/mp4'
    ];
    const mime = mimeTypes.find(m => MediaRecorder.isTypeSupported(m)) || 'video/webm';

    /* â”€â”€ start stream + recorder â”€â”€ */
    const stream   = offscreen.captureStream(30);
    const recorder = new MediaRecorder(stream, { mimeType: mime });
    const chunks   = [];
    recorder.ondataavailable = e => { if(e.data && e.data.size) chunks.push(e.data); };

    const totalDuration = slides.length * dytDur; /* seconds */
    const totalMs       = totalDuration * 1000;

    await new Promise(resolve => {
      recorder.onstop = () => {
        videoBlob = new Blob(chunks, { type: mime });
        if(videoURL) URL.revokeObjectURL(videoURL);
        videoURL = URL.createObjectURL(videoBlob);
        resolve();
      };

      /* start with timeslice so ondataavailable fires periodically */
      recorder.start(200);

      const startMs = performance.now();

      function tick(){
        const elapsed = performance.now() - startMs;

        if(elapsed >= totalMs){
          /* draw final frame then stop after a tiny delay so it gets captured */
          drawFrame(octx, W, H, slides[slides.length-1], 1);
          drawProgressDots(octx, W, H, slides, slides.length-1);
          setTimeout(() => recorder.stop(), 100);
          return;
        }

        const pct      = elapsed / totalMs;
        const slideIdx = Math.min(Math.floor(elapsed / (dytDur*1000)), slides.length-1);

        drawFrame(octx, W, H, slides[slideIdx], pct);
        drawProgressDots(octx, W, H, slides, slideIdx);

        /* UI feedback */
        genPct.textContent    = Math.round(pct*100)+'%';
        genStatus.textContent = `æ­£åœ¨æ¸²æŸ“ç¬¬ ${slideIdx+1}/${slides.length} å¹…â€¦`;

        requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    });

    /* â”€â”€ done â†’ show preview â”€â”€ */
    genWrap.classList.remove('show');
    prevWrap.classList.add('show');
    genBtn.disabled       = false;
    genPct.textContent    = '0%';
    genStatus.textContent = 'æ­£åœ¨ç”Ÿæˆè§†é¢‘â€¦';

    canvas.width  = W;
    canvas.height = H;
    playElapsed = 0;
    isPlaying   = false;
    renderPreviewFrame(0);
  });

  /* â”€â”€â”€ PREVIEW PLAYBACK â”€â”€â”€ */
  function renderPreviewFrame(elapsedSec){
    if(!slides.length) return;
    const slideIdx = Math.min(Math.floor(elapsedSec / dytDur), slides.length-1);
    drawFrame(ctx, 1080, 1920, slides[slideIdx], 0);
    drawProgressDots(ctx, 1080, 1920, slides, slideIdx);

    const totalDur = slides.length * dytDur;
    progFill.style.width = Math.min((elapsedSec/totalDur)*100,100)+'%';
  }

  function startPlay(){
    isPlaying     = true;
    playStartTime = performance.now();
    const totalDur = slides.length * dytDur;

    playBtn.innerHTML = '<svg viewBox="0 0 24 24"><rect x="6" y="4" width="4" height="16" fill="#fff"/><rect x="14" y="4" width="4" height="16" fill="#fff"/></svg>';
    playBtn.classList.add('playing');

    function loop(){
      if(!isPlaying) return;
      const nowSec = playElapsed + (performance.now()-playStartTime)/1000;
      if(nowSec >= totalDur){
        playElapsed     = 0;
        playStartTime   = performance.now();
        renderPreviewFrame(0);
        rafId = requestAnimationFrame(loop);
        return;
      }
      renderPreviewFrame(nowSec);
      rafId = requestAnimationFrame(loop);
    }
    rafId = requestAnimationFrame(loop);
  }

  function pausePlay(){
    isPlaying = false;
    if(rafId) cancelAnimationFrame(rafId);
    playElapsed += (performance.now()-playStartTime)/1000;

    playBtn.innerHTML = '<svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21" fill="#fff"/></svg>';
    playBtn.classList.remove('playing');
  }

  playBtn.addEventListener('click', () => { isPlaying ? pausePlay() : startPlay(); });

  /* â”€â”€â”€ DOWNLOAD â”€â”€â”€ */
  dlBtn.addEventListener('click', function(){
    if(!videoBlob) return;
    const ext = videoBlob.type.includes('mp4') ? 'mp4' : 'webm';
    const a   = document.createElement('a');
    a.href     = videoURL;
    a.download = 'AIæ—¥æŠ¥_'+new Date().toISOString().slice(0,10)+'.'+ext;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    this.textContent = 'âœ“ å·²ä¸‹è½½ï¼';
    this.classList.add('done');
    setTimeout(() => { this.textContent='â¬‡ï¸ ä¸‹è½½è§†é¢‘'; this.classList.remove('done'); }, 2200);
  });

  /* â”€â”€â”€ COPY SCRIPT â”€â”€â”€ */
  cpBtn.addEventListener('click', function(){
    const today = new Date().toLocaleDateString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit'});
    let script  = `ğŸ¬ AIæ—¥æŠ¥ æŠ–éŸ³è§†é¢‘è„šæœ¬ | ${today}\n`;
    script += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
    script += `ã€å°é¢ã€‘AI æ—¥æŠ¥ â€“ æ¯æ—¥æ™ºèƒ½èµ„è®¯æ±‡æ€»\n\n`;
    NEWS.filter(i=>i.hot).slice(0,dytCount).forEach((item,i) => {
      script += `ã€ç¬¬${i+1}é¡µ â€“ ${CAT_LABELS[item.cat]||item.cat}ã€‘\n`;
      script += `æ ‡é¢˜ï¼š${item.title}\n`;
      script += `å†…å®¹ï¼š${item.summary}\n`;
      script += `æ¥æºï¼š${item.source}\n\n`;
    });
    script += `ã€ç»“å°¾ã€‘æ›´å¤šèµ„è®¯è®¿é—® AI DAILY æ±‡æ€»ç«™\n`;
    script += `#AIæ—¥æŠ¥ #äººå·¥æ™ºèƒ½ #æŠ–éŸ³`;

    navigator.clipboard.writeText(script).then(() => {
      this.textContent = 'âœ“ å·²å¤åˆ¶ï¼';
      this.classList.add('done');
      setTimeout(() => { this.textContent='ğŸ“‹ å¤åˆ¶è„šæœ¬'; this.classList.remove('done'); }, 2200);
    });
  });

})();

/* â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(async function init() {
  // 1. åŠ è½½æ–°é—»æ•°æ®
  await loadNewsData();
  
  // 2. æ¸²æŸ“é¡µé¢
  renderAll();

  // 3. å¯åŠ¨æ—¶é—´æ›´æ–°
  function updateTime(){
    const now = new Date();
    const m = String(now.getMonth()+1).padStart(2,'0');
    const d = String(now.getDate()).padStart(2,'0');
    const h = String(now.getHours()).padStart(2,'0');
    const mi = String(now.getMinutes()).padStart(2,'0');
    document.getElementById('liveTime').textContent = `å·²æ›´æ–° ${m}æœˆ${d}æ—¥ ${h}:${mi}`;
  }
  updateTime();
  setInterval(updateTime, 30000);
  
  console.log('âœ… AI Daily åˆå§‹åŒ–å®Œæˆ');
})();
</script>
</body>
</html>
